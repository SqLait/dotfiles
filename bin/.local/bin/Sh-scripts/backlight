#!/bin/sh

# Use brightnessctl to naturally adjust laptop screen brightness and send a notification

ICON_PATH="/home/deanr/.local/share/icons/dunst"

currentbrightness=$(brightnessctl -e1 -m | awk -F, '{print substr($4, 0, length($4)-1)}')
if [ "$currentbrightness" -lt 1 ] && [ "$1" = "down" ]; then exit 1; fi

send_notification() {
	brightness=$(brightnessctl -e1 -m | awk -F, '{print substr($4, 0, length($4)-1)}')
	if [ "$brightness" -lt 33 ]; then
		ICON="brightness"
	elif [ "$brightness" -lt 66 ]; then
		ICON="brightness"
	else
		ICON="brightness"
	fi
    notify-send -a "Backlight" \
        -u normal \
        -t 2001 \
        -h int:value:"$brightness" \
        -h string:synchronous:brightness \
        "Brightness" "Currently at $brightness%"
}

case $1 in
	up)
		brightnessctl -e1 set +2%
		send_notification "$1"
		;;
	down)
		brightnessctl -e1 set 2%-
		send_notification "$1"
		;;
esac

